# Android Kotlin UiObject2 starter

## Overview/ Runbook

Starter pack for writing automator tests outside of your main project.

1. Add packages you want to be able to start in android manifest (may be required for running tests on androids > 10)

```
...
    <queries>
        <package android:name="__PACKAGE_NAME_1__" />
        <package android:name="__PACKAGE_NAME_2__" />
        <package android:name="__PACKAGE_NAME_3__" />
    </queries>
...
```

2. Place your tests in `./app/src/main/java/com/example/externaluitests` package
3. Build test applications with `./gradlew assembleAndroidTest`. (For more tasks run `./gradlew tasks`)
4. Install apps on device(s) with `./gradlew installDebug installDebugAndroidTest` (Device may prompt to confirm installation from untrusted source)
5. Check installed instrumentations with `adb shell pm list instrumentation`
6. Run tests:
  - Package:
```
adb shell am instrument -r -w -e package com.example.externaluitests com.example.externaluitests.test/androidx.test.runner.AndroidJUnitRunner`
```
  - Class:
```
adb shell am instrument -r -w -e class com.example.externaluitests.AutoGenerated com.example.externaluitests.test/androidx.test.runner.AndroidJUnitRunner`
```
  - Method:
```
adb shell am instrument -r -w -e class com.example.externaluitests.AutoGenerated#scrollVertically com.example.externaluitests.test/androidx.test.runner.AndroidJUnitRunner`
```

7. Clean device(s) and project with `./gradlew uninstallAll`, `./gradlew clean`

8. For faster reinstall you can run combined command:

```
./gradlew uninstallAll
./gradlew clean
./gradlew assembleAndroidTest
./gradlew installDebug installDebugAndroidTest
adb shell pm list instrumentation
adb shell am instrument -r -w -e package com.example.externaluitests com.example.externaluitests.test/androidx.test.runner.AndroidJUnitRunner
```

## Troubleshooting

1. If tests wont start as something crashed before app started, worth to restart device(s)
2. Take care of proper package name when running on different environments
3. Take care of proper credentials if app needs them when running on different environments
